<!DOCTYPE html>
<html lang="en">
	<head>
		<title>WIT.ai test</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	</head>
	<style>
		body { 	font-family:Verdana,Geneva,sans-serif;font-size:13px; margin:20px; }
	</style>
	<body>
		<input type="text" id="inp"/>
		<br><br>
		<div id="outp"></div>
	
	<script>

		const SERVER_TOKEN="3ISBCQZSCQ37KJIZA7U2VFFSGEM75NDH";
		const CLIENT_TOKEN="HZNYC4A6QBJ5D6U6W4WDVGCIQIOQFADK";	

		$("#inp").on("change",()=>{ GetWit($("#inp").val()); });
	
	
		function GetWit(q) 
		{
			q=encodeURIComponent(q);
			const url="https://api.wit.ai/traits?v=20210806"
			let body={  name:"phase", values:[] }
  			fetch(url,{ method:"POST",
						headers: { Authorization:'Bearer '+SERVER_TOKEN, 'Content-Type':'application/json'}, 
						body: JSON.stringify(body)
						})	
				.then(res => res.json())
				.then(res => console.log(res))


	
	return;

	
	
					

/*			const uri = 'https://api.wit.ai/message?&q=' + q;
				fetch(uri, {headers: {Authorization: 'Bearer ' + CLIENT_TOKEN}})
				.then(res => res.json())
				.then(res => ShowIntents(res))
*/


			}

		function ShowIntents(res)
		{
			let i,k;str=""
			for (let i=0;i<res.intents.length;++i)
				str=res.intents[i].name.replace(/liza_/,"").toUpperCase()+"="+Math.floor(res.intents[i].confidence*100)+"% &nbsp;";
			for (k in res.traits)
				str+=k.replace(/wit\$/,"")+"="+Math.floor(res.traits[k][0].confidence*100)+"% &nbsp;";
				$("#outp").html(str);
			console.log(res)
		}




	</script>
	</body>
</html>


